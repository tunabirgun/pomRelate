<!DOCTYPE html>
<html lang="en" data-theme="dark">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description"
    content="pomRelate - Static bioinformatics tool for cross-species gene analysis in model organisms centered on S. pombe. Explore protein-protein interactions, gene aliases, GO terms, and KEGG pathways.">
  <title>pomRelate — Model Organism Cross-Species Gene Analysis</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <!-- ===== HEADER ===== -->
  <header class="header">
    <div class="header-inner">
      <div class="logo-group">
        <h1 class="logo">pom<span class="logo-accent">Relate</span></h1>
        <span class="logo-subtitle">Model Organism Cross-Species Gene Analysis</span>
      </div>
      <div class="header-controls">
        <button id="about-btn" class="btn btn-ghost" title="About">About</button>
        <button id="theme-toggle" class="btn btn-icon" title="Toggle theme">
          <svg class="icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
            stroke-width="2">
            <circle cx="12" cy="12" r="5" />
            <path
              d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" />
          </svg>
          <svg class="icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
            stroke-width="2">
            <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z" />
          </svg>
        </button>
      </div>
    </div>
  </header>

  <!-- ===== DB VERSION MODAL ===== -->
  <div id="db-modal" class="modal" hidden>
    <div class="modal-backdrop"></div>
    <div class="modal-content large-modal">
      <div class="modal-header">
        <h2>About pomRelate</h2>
        <button class="modal-close" aria-label="Close">&times;</button>
      </div>
      <div class="modal-body">
        <div class="modal-tabs">
          <button class="modal-tab active" data-target="about-general">About</button>
          <button class="modal-tab" data-target="about-methods">Methods</button>
          <button class="modal-tab" data-target="about-references">References</button>
          <button class="modal-tab" data-target="db-version-list">Databases</button>
        </div>
        <div id="about-general" class="modal-tab-content active">
          <p><strong>pomRelate</strong> is a static, client-side tool for cross-species gene analysis in
            model organisms, centered on <em>Schizosaccharomyces pombe</em>.
          </p>
          <p>It enables researchers to seamlessly map orthologs, visualize protein-protein interaction (PPI) networks,
            perform functional enrichment analysis (GO &amp; KEGG), and explore phylogenetic relationships through
            pre-computed gene trees across 7 model organisms &mdash; all entirely in the browser with no backend server required.</p>
        </div>
        <div id="about-methods" class="modal-tab-content">
          <h3>Orthology Mapping</h3>
          <p>Orthologs are mapped using NOG-based orthology from <strong>STRING v12.0</strong> at the Eukaryota
            level, with alias-based name matching as fallback.
          </p>
          <h3>PPI Networks</h3>
          <p>Interaction data is sourced from <strong>STRING v12.0</strong>. The network visualization uses a
            force-directed layout to cluster related proteins. <strong>Hub genes</strong> are identified based on degree
            centrality.</p>
          <h3>Enrichment Analysis</h3>
          <p>GO and KEGG enrichment is performed using a Fisher's Exact Test (Hypergeometric test) with
            Benjamini-Hochberg FDR correction. Background sets are species-specific genome-wide annotations.</p>
          <h3>Hierarchical Clustering (Tree View)</h3>
          <p>Enriched terms can be clustered into a dendrogram based on gene set overlap. The pairwise
            <strong>Jaccard distance</strong> (1 &minus; |A &cap; B| / |A &cup; B|) measures how similar two terms'
            gene sets are. <strong>UPGMA</strong> agglomerative clustering groups terms with the most shared genes
            together. The resulting tree helps identify functional modules &mdash; clusters of related biological
            processes enriched in your gene set.</p>
          <h3>Phylogeny Analysis</h3>
          <p>Gene trees are derived from <strong>eggNOG v7</strong> pre-computed protein family phylogenies
            (Hern&aacute;ndez-Plaza et al., 2026), pruned to model organism species. Orthologous group (NOG)
            assignments are obtained from <strong>STRING v12.0</strong> hierarchical orthology data at the Eukaryota
            level (taxonomy ID 2759). eggNOG v7 tree tip labels use the same <code>taxid.UniProtID</code> format
            as STRING, enabling direct protein ID matching. Trees are rendered as rectangular cladograms with
            query genes highlighted in red and target species genes in blue. Hover over any leaf node to see
            species, gene IDs, orthogroup, branch length, and links to eggNOG, STRING, and UniProt.</p>
        </div>
        <div id="about-references" class="modal-tab-content">
          <h3>References</h3>
          <p style="margin-bottom:0.75rem;">Szklarczyk, D., Kirsch, R., Koutrouli, M., Nastou, K., Mehryary, F., Hachilif, R., Gable, A. L., Fang, T., Doncheva, N. T., Pyysalo, S., Bork, P., Jensen, L. J., &amp; von Mering, C. (2023). The STRING database in 2023: Protein–protein association networks and functional enrichment analyses for any sequenced genome of interest. <em>Nucleic Acids Research</em>, <em>51</em>(D1), D483–D489. <a href="https://doi.org/10.1093/nar/gkac1000" target="_blank">https://doi.org/10.1093/nar/gkac1000</a></p>
          <p style="margin-bottom:0.75rem;">Kanehisa, M., Furumichi, M., Sato, Y., Kawashima, M., &amp; Ishiguro-Watanabe, M. (2023). KEGG for taxonomy-based analysis of pathways and genomes. <em>Nucleic Acids Research</em>, <em>51</em>(D1), D587–D592. <a href="https://doi.org/10.1093/nar/gkac963" target="_blank">https://doi.org/10.1093/nar/gkac963</a></p>
          <p style="margin-bottom:0.75rem;">The Gene Ontology Consortium. (2023). The Gene Ontology knowledgebase in 2023. <em>Genetics</em>, <em>224</em>(1), iyad031. <a href="https://doi.org/10.1093/genetics/iyad031" target="_blank">https://doi.org/10.1093/genetics/iyad031</a></p>
          <p style="margin-bottom:0.75rem;">Amos, B., Aurrecoechea, C., Barber, M., Baber, P., Blevins, A. S., Brunk, B. P., Caler, E., Fischer, S., Harb, O. S., Kissinger, J. C., Li, W., Pennington, C., Pinney, D. F., Roos, D. S., &amp; Stoeckert, C. J. (2022). VEuPathDB: The eukaryotic pathogen, vector and host bioinformatics resource center. <em>Nucleic Acids Research</em>, <em>50</em>(D1), D898–D911. <a href="https://doi.org/10.1093/nar/gkab929" target="_blank">https://doi.org/10.1093/nar/gkab929</a></p>
          <p style="margin-bottom:0.75rem;">Hern&aacute;ndez-Plaza, A., Szklarczyk, D., Coelho, L. P., Mathieson, M., Kuhn, M., Forslund, S. K., Jensen, L. J., von Mering, C., &amp; Bork, P. (2026). eggNOG v7: phylogeny-based orthology predictions and functional annotations. <em>Nucleic Acids Research</em>, <em>54</em>(D1), D402. <a href="https://doi.org/10.1093/nar/gkaf1249" target="_blank">https://doi.org/10.1093/nar/gkaf1249</a></p>
        </div>
        <div id="db-version-list" class="modal-tab-content"></div>
      </div>
    </div>
  </div>

  <!-- ===== MAIN ===== -->
  <main class="main">
    <!-- INPUT PANEL -->
    <section class="panel input-panel" id="input-panel">
      <h2 class="panel-title">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
        </svg>
        Query
      </h2>

      <div class="form-group">
        <label class="form-label">Source Species</label>
        <select id="source-species" class="form-select">
          <option value="">Loading species...</option>
        </select>
        <div id="auto-detect-hint" class="auto-detect-hint" hidden></div>
      </div>

      <div class="form-group">
        <label class="form-label">Gene List <span class="hint">(one per line or comma-separated)</span></label>
        <textarea id="gene-input" class="form-textarea" rows="6"
          placeholder="Enter gene names, locus tags, or protein IDs...&#10;&#10;e.g.&#10;cdc2&#10;cdc13&#10;wee1&#10;rad21"></textarea>
      </div>

      <div class="form-group">
        <label class="form-label">Target Species <span class="hint">(find aliases in)</span></label>
        <div id="target-species-list" class="checkbox-list"></div>
        <div class="checkbox-controls">
          <button class="btn btn-sm btn-ghost" id="select-all-targets">Select All</button>
          <button class="btn btn-sm btn-ghost" id="deselect-all-targets">Deselect All</button>
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">PPI Score Threshold</label>
        <div class="range-group">
          <input type="range" id="score-threshold" min="400" max="999" value="700" class="form-range">
          <input type="number" id="score-value-input" min="400" max="999" value="700"
            class="form-control form-control-sm" style="width: 70px; display: inline-block; margin-left: 0.5rem;">
        </div>
      </div>

      <button id="analyze-btn" class="btn btn-primary">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polygon points="5 3 19 12 5 21 5 3" />
        </svg>
        Analyze
      </button>
    </section>

    <!-- RESULTS PANEL -->
    <section class="panel results-panel" id="results-panel">
      <div id="results-placeholder" class="placeholder">
        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"
          opacity="0.3">
          <path
            d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
        </svg>
        <p>Select a source species, enter genes, and click <strong>Analyze</strong> to begin.</p>
      </div>

      <div id="results-content" hidden>
        <div class="results-tabs">
          <button class="tab active" data-tab="aliases">Orthologs</button>
          <button class="tab" data-tab="ppi">Interactions</button>
          <button class="tab" data-tab="ppi-network">Network</button>
          <button class="tab" data-tab="go">GO Terms</button>
          <button class="tab" data-tab="kegg">KEGG Terms</button>
          <button class="tab" data-tab="go-enrichment">GO Enrichment</button>
          <button class="tab" data-tab="kegg-enrichment">KEGG Enrichment</button>
          <button class="tab" data-tab="phylogeny">Phylogeny</button>
        </div>

        <div id="tab-aliases" class="tab-content active"></div>
        <div id="tab-ppi" class="tab-content"></div>

        <div id="tab-ppi-network" class="tab-content">
          <div class="download-bar">
            <span class="download-label">Export Network:</span>
            <button class="download-btn" id="net-png-btn">PNG</button>
            <button class="download-btn" id="net-svg-btn">SVG</button>
            <button class="download-btn" id="net-pdf-btn">PDF</button>
            <div class="ppi-legend">
              <span class="ppi-legend-item" title="Genes from your input list"><span class="ppi-dot query"></span>
                Query</span>
              <span class="ppi-legend-item" title="Highly connected genes that bridge clusters"><span
                  class="ppi-dot hub"></span> Hub</span>
              <span class="ppi-legend-item" title="Other proteins interacting with your query/hub genes"><span
                  class="ppi-dot interactor"></span> Interactor</span>
            </div>
          </div>
          <div id="ppi-network-plot" class="plot-container"></div>
        </div>

        <div id="tab-go" class="tab-content"></div>
        <div id="tab-kegg" class="tab-content"></div>

        <div id="tab-go-enrichment" class="tab-content"></div>
        <div id="tab-kegg-enrichment" class="tab-content"></div>
        <div id="tab-phylogeny" class="tab-content"></div>
      </div>

      <div id="loading-overlay" class="loading" hidden>
        <div class="spinner"></div>
        <p id="loading-text">Loading data...</p>
      </div>
    </section>
  </main>

  <!-- ===== FOOTER ===== -->
  <footer class="footer">
    <p>Copyright &copy; <a href="https://tunabirgun.com/" target="_blank" rel="noopener noreferrer">tunabirgun</a>
    </p>
  </footer>

  <!-- Gene Tooltip -->
  <div id="gene-tooltip" class="gene-tooltip" hidden></div>

  <script src="enrichment.js"></script>
  <script src="plots.js"></script>
  <script src="export.js"></script>
  <script src="network.js"></script>
  <script src="phylogeny.js"></script>
  <script src="app.js"></script>
</body>

</html>
